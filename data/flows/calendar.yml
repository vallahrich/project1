flows:
  add_calendar_event:
    name: "Add Calendar Event"
    description: "This flow helps users schedule events in their calendar by collecting event details like title, date, time, and duration."
    run_pattern_completed: true
    nlu_trigger:
      - intent: add_calendar_event
      - intent: inform_event_details
    steps:
      # Direct input with all information
      - noop: true
        next:
          - if: "context.intent == 'add_calendar_event' AND context.entities.event_title AND context.entities.event_date AND context.entities.event_time AND context.entities.event_duration"
            then:
              - set_slots:
                  - event_title: "${context.entities.event_title}"
                  - event_date: "${context.entities.event_date}"
                  - event_time: "${context.entities.event_time}"
                  - event_duration: "${context.entities.event_duration}"
              - action: action_add_calendar_event
              - action: utter_appointment_saved
                next: END
          - else:
              - set_slots:
                  - correction_attempts: 0
              - action: utter_ask_event_title
                next: collect_title

      - id: collect_title
        collect: event_title
        description: "The title or name of the calendar event"
        next: collect_date

      - id: collect_date
        collect: event_date
        description: "The date for the event in YYYY-MM-DD format"
        next: collect_time

      - id: collect_time
        collect: event_time
        description: "The time for the event in HH:MM format"
        next: collect_duration

      - id: collect_duration
        collect: event_duration
        description: "The duration of the event in minutes"
        utter: utter_ask_event_duration
        next: create_event

      - id: create_event
        action: action_add_calendar_event
        next: confirm_saved

      - id: confirm_saved
        action: utter_appointment_saved
        next: END 